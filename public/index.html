<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi negocio al dia</title>
  <link rel="stylesheet" href="/css/style.css">

</head>

<body>

  <script>

    if (localStorage.getItem("logged") !== "true") {
      window.location.href = "/login/login.html";
    }
  </script>

    <script>

      const role = localStorage.getItem("currentRole");

      document.addEventListener("DOMContentLoaded", () => {
        if (role === "user") {
          document.querySelector('[data-target="procesos"]').style.display = "none";
          document.querySelector('[data-target="control"]').style.display = "none";
          document.querySelector('[data-target="usuarios"]').style.display = "none";

          document.getElementById("procesos").style.display = "none";
          document.getElementById("control").style.display = "none";
          document.getElementById("usuarios").style.display = "none";
        }
      });
    </script>



  <!-- MENÃš LATERAL -->
  <aside>

    <div class="logo">ğŸ§­ GestiÃ³n</div>
    <div class="menu">
      <button class="menu-btn active" data-target="entrada">ğŸ“¥ Entrada</button>
      <button class="menu-btn" data-target="procesos">âš™ï¸ Procesos</button>
      <button class="menu-btn" data-target="salidas">ğŸ“¤ Salidas</button>
      <button class="menu-btn" data-target="control">ğŸ§° Control</button>
    </div>

  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <main>

    <header>

      <h1>Mi negocio al dia </h1>

      <div class="user-info">
        <button class="btn small-btn" onclick="switchSection('usuarios')" id="headerUser"></button>
        <a href="#" onclick="logout()" class="logout-link">Logout</a>
      </div>

    </header>

    <div class="content">
      
      <!-- ===== MÃ“DULO 1: ENTRADA ===== -->
      <section id="entrada" class="section active">
        <h2>ğŸ“¥ MÃ³dulo 1: Entrada</h2>
        <p>Registro y gestiÃ³n de informaciÃ³n inicial del sistema.</p>

        <h3>Registrar Nuevo Producto</h3>

        <div class="form-group">
          <div>
            <label>Nombre del Producto *</label>
            <input type="text" id="prodName" placeholder="Ej: Agua Mineral">
          </div>

          <div>
            <label>CategorÃ­a *</label>
            <select id="prodCategory">
              <option value="">Seleccionar categorÃ­a</option>
              <option>Bebidas</option>
              <option>Alimentos</option>
              <option>ElectrÃ³nica</option>
              <option>Ropa</option>
              <option>Otros</option>
            </select>
          </div>

          <div>
            <label>Precio Unitario ($) *</label>
            <input type="number" id="prodPrice" placeholder="0.00" step="0.01">
          </div>

          <div>
            <label>Cantidad Inicial *</label>
            <input type="number" id="prodQty" placeholder="0" min="0">
          </div>

          <button class="btn" onclick="addProduct()" style="grid-column: 1/-1;">Registrar Producto</button>
        </div>

        <h3>ğŸ“¦ Productos Registrados</h3>
        <div id="productsTable"></div>

        <h3>ğŸ“Š Ventas del DÃ­a</h3>
        <div class="form-group">

          <div>
            <label>Seleccionar Producto *</label>
            <select id="saleProduct">
              <option value="">Seleccionar...</option>
            </select>
          </div>

          <div>
            <label>Cantidad Vendida *</label>
            <input type="number" id="saleQty" placeholder="1" min="1">
          </div>

          <div>
            <label>Precio de Venta ($) *</label>
            <input type="number" id="salePrice" step="0.01">
          </div>

          <button class="btn" onclick="recordSale()" style="grid-column: 1/-1;">Registrar Venta</button>

        </div>

        <div id="salesTable"></div>
      </section>

      <!-- ===== MÃ“DULO 2: PROCESOS ===== -->
      <section id="procesos" class="section">
        <h2>âš™ï¸ MÃ³dulo 2: Procesos del Sistema</h2>
        <p>AnÃ¡lisis y transformaciÃ³n de informaciÃ³n.</p>

        <h3>ğŸ“ˆ Resumen Financiero</h3>
        <div class="stats-grid" id="statsGrid"></div>

        <h3>ğŸ“¦ Estado del Inventario</h3>

        <div class="form-group">

          <input type="text" id="searchProduct" placeholder="Buscar producto...">
          <button class="btn" onclick="filterInventory()">Buscar</button>
          <button class="btn secondary" onclick="loadInventory()">Ver Todo</button>
        </div>

        <div id="inventoryTable"></div>

        <h3>ğŸ’° Flujo de Caja Diario</h3>
        <div id="cashFlowTable"></div>
      </section>

      <!-- ===== MÃ“DULO 3: SALIDAS ===== -->
      <section id="salidas" class="section">
        <h2>ğŸ“¤ MÃ³dulo 3: Salidas</h2>
        <p>Reportes, alertas y estadÃ­sticas.</p>

        <h3>âš ï¸ Alertas del Sistema</h3>
        <div id="alertsContainer"></div>

        <h3>ğŸ“Š EstadÃ­sticas de Ventas</h3>

        <div class="card-container">
          <div class="card">

            <h4>Total de Ventas</h4>
            <div class="card-value" id="totalSales">$0</div>
            <p id="totalSalesCount">0 transacciones</p>

          </div>

          <div class="card">
            <h4>Producto MÃ¡s Vendido</h4>
            <div class="card-value" id="topProduct">N/A</div>
            <p id="topProductCount">0 unidades</p>
          </div>

          <div class="card">
            <h4>Producto Bajo Stock</h4>
            <div class="card-value" id="lowStockCount">0</div>
            <p>Requieren reorden</p>
          </div>

        </div>

        <h3>ğŸ“‹ Reporte de Transacciones</h3>
        <div id="reportsTable"></div>

        <button class="btn" onclick="exportReport()" style="margin-top: 20px;">ğŸ“¥ Descargar Reporte (CSV)</button>
      </section>

      <!-- MÃ“DULO 4: CONTROL -->
      <section id="control" class="section">
        <h2>ğŸ§° MÃ³dulo 4: Sistema de Control</h2>
        <p>Validaciones, seguridad y mantenimiento.</p>

        <h3>âœ… Validaciones del Sistema</h3>
        <div class="form-group">
          <button class="btn" onclick="validateData()" style="grid-column: 1/-1;">Ejecutar ValidaciÃ³n Completa</button>
        </div>
        <div id="validationResult"></div>

        <h3>ğŸ’¾ Copias de Seguridad</h3>
        <div class="form-group">
          <button class="btn" onclick="backupData()" style="grid-column: 1/-1;">Crear Respaldo Ahora</button>
          <button class="btn secondary" onclick="restoreData()" style="grid-column: 1/-1;">Restaurar Ãšltimo Respaldo</button>
        </div>
        <div id="backupInfo"></div>



        <h3>ğŸ“ Feedback del Usuario</h3>

        <div class="form-group">

          <div style="grid-column: 1/-1;">
            <label>Tipo de Mensaje *</label>
            <select id="feedbackType">
              <option>Sugerencia</option>
              <option>Error</option>
              <option>Mejora</option>
            </select>
          </div>

          <div style="grid-column: 1/-1;">
            <label>Mensaje *</label>
            <textarea id="feedbackMsg" placeholder="Describe tu comentario..." rows="4"></textarea>
          </div>

          <button class="btn" onclick="sendFeedback()" style="grid-column: 1/-1;">Enviar Feedback</button>

        </div>

        <h3>ğŸ”§ Mantenimiento</h3>
        <div class="form-group">
          <button class="btn danger" onclick="clearAllData()" style="grid-column: 1/-1;">âš ï¸ Limpiar Todos los Datos (Irreversible)</button>
        </div>
      </section>



      <!--  MÃ“DULO 5: USUARIOS -->
      <section id="usuarios" class="section">
      <h2>ğŸ‘¥ AdministraciÃ³n de Usuarios</h2>
      <p>Gestiona las cuentas registradas en el sistema.</p>

      <h3>Usuarios Registrados</h3>
      <div id="usersTable"></div>

      <h3>Crear Nuevo Usuario</h3>
      <div class="form-group">
        <div>
          <label>Usuario</label>
          <input type="text" id="newUser" placeholder="Nombre de usuario">
        </div>

        <div>
          <label>Correo</label>
          <input type="email" id="newEmail" placeholder="Correo electrÃ³nico">
        </div>

        <div>
          <label>ContraseÃ±a</label>
          <input type="password" id="newPass" placeholder="ContraseÃ±a">
        </div>

        <div>
          
          <label>Rol</label>
          <select id="newRole">
            <option value="admin">Administrador</option>
            <option value="user">Vendedor</option>
          </select>

        </div>

        <button class="btn" onclick="createUser()" style="grid-column: 1/-1;">Crear Usuario</button>
      </div>
    </section>

      </section>


    </div>
  </main>

<script src="/js/app.js"></script>

</body>
</html>